---
html:
  embed_local_images: true
  embed_svg: true
  offline: true
  toc: true
export_on_save:
  html: true
---

# template markdown

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [template markdown](#template-markdown)
  - [凡例](#凡例)
  - [pythonインストール](#pythonインストール)
    - [Pythonのバージョンについて](#pythonのバージョンについて)
    - [Pythonインストーラの入手](#pythonインストーラの入手)
    - [Pythonインストーラの実行](#pythonインストーラの実行)
    - [Pythonインストールできたことの確認](#pythonインストールできたことの確認)
    - [Pythonインストールできたことの確認 その2](#pythonインストールできたことの確認-その2)
  - [VSCodeインストール](#vscodeインストール)
    - [VSCodeインストーラの入手](#vscodeインストーラの入手)
    - [VSCodeインストーラの実行](#vscodeインストーラの実行)
  - [VSCodeでのPython開発](#vscodeでのpython開発)
    - [VSCodeに関する補足](#vscodeに関する補足)
      - [ワークスペースについて](#ワークスペースについて)
      - [日本語化](#日本語化)
  - [章立て](#章立て)

<!-- /code_chunk_output -->

## 凡例

本書内での記述例を示す。

:::tip
知っておくと便利な小技系
:::

:::info
知っておいた方がよさそうな情報
:::

:::note
おまけ的なメモ・自分語り
:::

:::warning
極めてリスクの高い事例
:::

:::caution
注意深く利用する必要のある事例
:::

:::sample
コマンドやコードのサンプル等
:::

## pythonインストール

以下順序でPythonのインストールを進める。  

1. 利用するバージョンについて
1. インストーラの入手
1. インストーラの実行
1. インストールできたことの確認

### Pythonのバージョンについて

Pythonには大まかに2.n系と3.n系が存在する。  
どちらを利用することもありうるが、本書では最新のPython環境を利用する。  
それぞれの主な特徴は下図の通り。  

![Ver](./img/01Python/01.drawio.png)

:::info
Pythonには派生形が多数存在する。  
・Circuit Python  
・Micro Python  
・Iron Python  
・etc.  
これらと区別するためにPython.orgからダウンロードできるPythonをCPythonと呼称することもある。
:::

:::note
筆者が現在利用しているメイン機では2.7, 3.7～3.11をインストールしている。  
このため、利用するバージョンを使い分ける手段が必要になる。  
バージョンを使い分ける手段は後述する。  
:::

### Pythonインストーラの入手

以下Python.orgのページからインストーラをダウンロードする。  
[https://www.python.org/](https://www.python.org/)

Downloadsをクリックする。

![画像jpg](./img/01Python/10.png){.image_w900}

トップには最新バージョンが表示されるハズなのでクリックする。

![画像jpg](./img/01Python/11.png){.image_w900}

ブラウザのダウンローダに従って、名前を付けて保存する。

![画像jpg](./img/01Python/12.png){.image_w900}

適当なフォルダへ保存する。  
下図は一例として「ダウンロード」フォルダへ、そのままのファイル名で保存している。  

![画像jpg](./img/01Python/13.png){.image_w900}

### Pythonインストーラの実行

公式のインストール手順は以下にある。  
[https://docs.python.org/ja/3/using/windows.html](https://docs.python.org/ja/3/using/windows.html)

:::note
Pythonは敷居の低さゆえに粗製乱造されたネット記事が多いうえ、昨今は生成AIの影響で粗悪さに拍車がかかっている。  
困ったことがあれば最初に公式ドキュメントを参照すること。  
ただし、公式ドキュメントは厳密さゆえに分かり難いこともあるので、ネット記事と行ったり来たりしながら正解を考えることも多分にありうる。  
:::

ダウンロードしたインストーラをダブルクリックする。

![画像jpg](./img/01Python/20.png){.image_w900}

「Add python.exe to PATH」のチェックボックスを有効にしてから、「Install Now」をクリックする。  

![画像jpg](./img/01Python/21.png){.image_w900}

:::info
「Add python.exe to PATH」とは。  
Windowsの環境変数PATHにPythonのインストールディレクトリを追加することを意味する。  
環境変数PATHに追加されたプログラムは、どのディレクトリからでも、フルパスを指定せずに実行できるようになる。  
このチェックボックスを有効にすることで、以下が同義になる。
・コマンドプロンプト上で「python」と入力する
・コマンドプロンプト上で「Python.exe」のフルパスを入力する
:::

:::Caution
環境変数PATHとは。  
Windowsがプログラムを探す際のディレクトリパスが登録されている。  
今回のようにインストーラが追加してくれる場合もあれば、ユーザが能動的に追加することも出来る。  
環境変数PATHへ追加しておけば、フルパスを毎回入力する手間が省けるので、作業効率が上がる。  
**乱用は厳禁。**  
システム全体に影響するため、乱用すると環境同士が衝突しうる可能性がある。  
一般ユーザが編集することはあまり想定されておらず、問題が生じた場合の原因も特定しにくい。  
機能をよく理解したうえで、本当に必要なディレクトリのみ登録すること。  
:::

:::info
「Use admin privileges when installing py.exe」とは。  
py.exeというpythonを管理するランチャーのインストール時に管理者権限を利用するか否か。  
PC内の全ユーザへインストールする場合に、管理者権限が必要となる。  
今回は全ユーザへインストールしないので、チェックボックスを有効にしない。
:::

インストールが開始されるので、完了するまで数分待機する。  

![画像jpg](./img/01Python/22.png){.image_w900}

インストール完了後、「Disable path length limit」が表示された場合はクリックする。  

![画像jpg](./img/01Python/23.png){.image_w900}

:::info
「Disable path length limit」とは。  
※ Windows側の設定なので、過去に設定済みの場合は本オプションは表示されない。  
昔のWindowsは、パスの長さが260文字に制限されていたため、261文字以上のパスは解決できずエラーになる。  
今のWindowsは、約32,000文字まで制限を緩和でき、その設定を有効化するのが本オプションである。  
これにより、Pythonにおける open()や osモジュール等、パスを扱うほとんどの機能で260文字より長いパスを利用できるようになる。
:::

:::note
無効のままでもいいが、有効化しておくことを推奨する。  
雑にPythonスクリプトを組むと、実行環境までのパス＋ログファイル名で260文字を超える状況は容易に発生する。  
:::

「Disable path length limit」をクリックした場合、Windows側の設定を変更することになる。  
ユーザアカウント制御が表示されるので、「はい」をクリックする。  

![画像jpg](./img/01Python/24.png){.image_w900}

上記設定の更新後、もしくは最初から「Disable path length limit」が表示されていない場合は、以下表示となる。  
「Close」を押下してインストール作業は終わり。  

![画像jpg](./img/01Python/25.png){.image_w900}

### Pythonインストールできたことの確認

まず、コマンドプロンプトを起動する。  
Windowsキー と Rキー を同時押しすることで、「ファイル名を指定して実行」ウィンドウが表示される。  
「cmd」と入力して Enterキーを押下する。  

![画像jpg](./img/01Python/30.png){.image_w900}

ホームディレクトリを表示した状態のコマンドプロンプトが起動する。  

![画像jpg](./img/01Python/31.png){.image_w900}

「python」と入力して Enterキーを押下し、以下表示になればPythonのインストールに成功している。  

![画像jpg](./img/01Python/32.png){.image_w900}

:::info
">>> "の待ち受け状態は、いわゆる対話モードを示す。
行単位で処理を実行できるので、ごく簡単な動作確認程度ならこの状態で試すことも可能。  
:::

試しに以下コマンド入力すれば`Hello World!`が出力され、問題なく動作することが分かる。  

:::sample
print('Hello World!')
:::

![画像jpg](./img/01Python/33.png){.image_w900}

実行中は変数も保持するので、以下のような演算を行うことも可能である。  

:::sample
print('Hello World!')
:::

![画像jpg](./img/01Python/34.png){.image_w900}

対話モードを終了するには以下コマンドを実行する。  

:::sample
quit()
:::

![画像jpg](./img/01Python/35.png){.image_w900}

### Pythonインストールできたことの確認 その2

インストール手順の途中で登場した「py.exe」を利用することでもインストール状態の確認ができる。  
以下コマンドを利用すると、インストール済みのPythonを一覧表示できる。  
一覧に今回インストールしたバージョンが表示されれば、インストールに成功している。  

:::sample
py --list
:::

![画像jpg](./img/01Python/36.png){.image_w900}

## VSCodeインストール

以下順序でVSCodeのインストールを進める。  

1. インストーラの入手
1. インストーラの実行
1. インストールできたことの確認

### VSCodeインストーラの入手

以下公式ページからインストーラをダウンロードする。  
[https://code.visualstudio.com/](https://code.visualstudio.com/)

Download for Windowsをクリックする。

![画像jpg](./img/02VSCode/01.png){.image_w900}

画面遷移後、待機しているとダウンロードが始まるのでブラウザのダウンローダに従って、名前を付けて保存する。

![画像jpg](./img/02VSCode/02.png){.image_w900}

適当なフォルダへ保存する。  
下図は一例として「ダウンロード」フォルダへ、そのままのファイル名で保存している。  

![画像jpg](./img/02VSCode/03.png){.image_w900}

※ 「ダウンロード」フォルダには前出の手順でダウンロードしたpythonインストーラが残っている

### VSCodeインストーラの実行

ダウンロードしたインストーラをダブルクリックする。

![画像jpg](./img/02VSCode/10.png){.image_w900}

使用許諾を確認のうえ、「同意する」のラジオボタンを選択してから、「次へ」をクリックする。  

![画像jpg](./img/02VSCode/11.png){.image_w900}

インストール先のフォルダは基本的にデフォルトのままで問題ない。  
「次へ」をクリックする。  

![画像jpg](./img/02VSCode/12.png){.image_w900}

スタートメニューフォルダも基本的にデフォルトのまま作成しておけば問題ない。  
「次へ」をクリックする。  

![画像jpg](./img/02VSCode/13.png){.image_w900}

追加タスクも基本的にデフォルトのままで問題ない。  

- デスクトップ上にアイコンを作成: 任意
- コンテキストメニューへアクションを追加: 非推奨  
コンテキストメニューの項目が増えると使いにくなるので、あまりお勧めしない。
- サポートされているファイルの種類のエディタとして、Codeを登録する: 任意
- PATHへの追加: 推奨  
発展的な作業も行うようになると、環境変数PATHへ追加してあった方が助かる。  
環境変数PATHの説明は、Pythonインストール時の説明の通り。  

![画像jpg](./img/02VSCode/14.png){.image_w900}

最後に設定を確認して、「インストール」をクリックする。  

![画像jpg](./img/02VSCode/15.png){.image_w900}

数秒だけ準備画面が表示される。  

![画像jpg](./img/02VSCode/16.png){.image_w900}

上記後インストールが開始されるので、完了するまで数秒待機する。  

![画像jpg](./img/02VSCode/17.png){.image_w900}

インストールを終えたら、「完了」をクリックする。

![画像jpg](./img/02VSCode/18.png){.image_w900}

以下のようにVSCodeが起動すれば、問題なくインストール完了である。  
※ 初期画面はバージョンによって異なる可能性が高い

![画像jpg](./img/02VSCode/19.png){.image_w900}

## VSCodeでのPython開発

具体的なPython開発環境の構築へ入る前に、まずは簡単な挙動確認をできるようにする。

### VSCodeに関する補足

#### ワークスペースについて

VSCodeはテキストエディタである。  
だが、単なるテキストエディタではない。  
拡張機能を利用することで、開発言語や目的に応じた環境を用意できる高拡張性を備えたテキストエディタである。  

拡張機能は誰でも開発できるため、インターネット上には無数に存在する。  
これら拡張機能を不用意に追加すると、環境やショートカットキーが衝突し、使い難くなってしまう。  

そこで、「ワークスペース」という概念が存在する。  
プロジェクトごとに環境や設定を独立して管理でき、設定の衝突を避けることができる。  

:::warning
利用する拡張機能には要注意!!  
悪意ある拡張機能も公開されているため、安易に利用すべきでない。  
必ず利用許可を確認すること。  
また、悪意ある拡張機能はタイポを狙った名前のものも存在する。  
利用許可のある拡張機能を利用する際にも、拡張機能の名前やパブリッシャはよく確認すること。  
:::

#### 日本語化

VSCodeはデフォルトで英語なので、日本語化しておく。  
日本語化にも拡張機能を利用する。  

下図中の四角が4つ組み合わせられたボタンをクリックして、拡張機能のタブを開く。  
拡張機能タブを開くのは、「Ctrl + Shift + X」のショートカットキーでも可能。  

検索窓に「japanese」と入力するだけで複数の拡張機能がヒットすることが分かる。  

![画像jpg](./img/03VSCode+Python/00.png){.image_w900}

一番上に表示される
「Japanese Language Pack for Visual Studio Code」の「install」ボタンをクリックする。

![画像jpg](./img/03VSCode+Python/01.png){.image_w900}

数秒してインストールに完了すると、下図のダイアログが表示されるので「Change Language and Restart」をクリックする。  

![画像jpg](./img/03VSCode+Python/02.png){.image_w900}

もしもダイアログが閉じてしまった場合は、「Ctrl + Shift + Pack」のショートカットキーで表示される検索窓にて「Configure Display」と入力して表示される「Configure Display Language」をクリックする。  

![画像jpg](./img/03VSCode+Python/03.png){.image_w900}

更に言語選択の項目が表示されるので日本語をクリックする。  

![画像jpg](./img/03VSCode+Python/04.png){.image_w900}

こちらの手順でも再起動を問われるので、「Restart」をクリックする。  

![画像jpg](./img/03VSCode+Python/05.png){.image_w900}

いずれの手順でもVSCodeが自動で再起動し、以下のように日本語表示されれば日本語化完了である。  

![画像jpg](./img/03VSCode+Python/06.png){.image_w900}

## 章立て

VSCode+pythonの環境構築
  python debuggerを利用すること

  VSIXからとってくることもできるが、スペルミスには要注意  
  基本的に許可リストにあるライブラリのみ利用すること  

単純なスクリプトを実行して、挙動確認

パッケージ管理・Pythonバージョンについて

uv/pipenv環境について

JupyterNotebook環境の作成
  ライブラリの注意点
  PyPIからとってくることもできるが、スペルミスには要注意  
  基本的に許可リストにあるライブラリのみ利用すること  

セルで実行

markdownによる文書を作成したい場合は、この環境を利用する。  

- 推奨事項に追加してある拡張機能を有効化すること。
- 上記有効化してあれば、目次も自動更新される。
